---
layout: default
title: Results
---

<style>
  /* --- Tab Navigation Styles --- */
  .tab-nav { overflow: hidden; border-bottom: 1px solid #ccc; margin-bottom: 20px; }
  .tab-nav a { float: left; display: block; color: #159957; text-align: center; padding: 14px 16px; text-decoration: none; font-size: 17px; border: 1px solid transparent; border-bottom: none; }
  .tab-nav a:hover { background-color: #f1f1f1; }
  .tab-nav a.active { background-color: #fff; border: 1px solid #ccc; border-bottom: 2px solid white; font-weight: bold; color: #000; margin-bottom: -1px; }
   
  /* --- Table Styles --- */
  table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
  th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
  th { background-color: #f2f2f2; font-weight: bold; }

  /* Rank Column Tweaks */
  th:first-child, td:first-child { width: 50px; text-align: center; }

  /* --- Medals & Colors --- */
  tr.rank-1 { background-color: #fff8db; border-left: 4px solid #ffd700; }
  tr.rank-2 { border-left: 4px solid #c0c0c0; }
  tr.rank-3 { border-left: 4px solid #cd7f32; }
  
  /* Medal Icons */
  tr.rank-1 td:first-child::after { content: " ðŸ¥‡"; }
  tr.rank-2 td:first-child::after { content: " ðŸ¥ˆ"; }
  tr.rank-3 td:first-child::after { content: " ðŸ¥‰"; }

  /* Group Headers */
  h2.group-header { margin-top: 3rem; border-bottom: 1px solid #e5e5e5; color: #159957; }

  /* Loading & Timestamp */
  .loading { text-align: center; font-style: italic; color: #606c71; margin: 20px 0; }
  #last-updated { text-align: right; font-size: 0.85rem; color: #666; font-style: italic; margin-bottom: 10px; }
  
  /* Mobile hide: Hides the Reg Nr on small phones */
  @media (max-width: 600px) { .hide-mobile { display: none; } }
</style>

<div class="tab-nav">
  <a href="./index.html">PÃ¥melding</a>
  <a href="./results.html" class="active">Resultater</a>
</div>

<h2>Resultater fra Ã¥rskonkurrasene</h2>
<p>Kontinuerlig oppdaterte inntil pÃ¥meldingsfrist er utlÃ¸pt:</p>

<div id="last-updated"></div>
<div id="loadingMessage" class="loading">Henter resultater...</div>
<div id="leaderboard-container"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

<script>
    // ==========================================
    // CONFIGURATION SECTION
    // ==========================================
    // 1. Paste your link here:
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTRjNCKLmtIE3VOoq0xxAjmTySCPEGKMVpX3s1TfUyNM3CbLAq-r1B5GVH-s-4natDAfK4OPUzv2Md5/pub?gid=334201077&single=true&output=csv'; 
    
    // 2. Exact Column Headers from Google Sheet:
    const col_name  = 'Hundens kennelnavn';
    const col_score = 'Poeng';
    const col_breed = 'Rase'; 
    const col_color = 'Farge';
    const col_reg   = 'Hundens reg. nr'; // NEW COLUMN
    // ==========================================

    Papa.parse(sheetUrl, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
            const data = results.data;
            const container = document.getElementById('leaderboard-container');
            const loadingMsg = document.getElementById('loadingMessage');
            
            updateTimestamp();

            // 1. Group the data
            const groups = {};
            data.forEach(row => {
                if(!row[col_name]) return; 

                const rase = (row[col_breed] || "").trim();
                const farge = (row[col_color] || "").trim();
                const key = farge ? `${rase} - ${farge}` : rase;
                
                if (!groups[key]) groups[key] = [];
                groups[key].push(row);
            });

            // 2. Sort Groups Alphabetically
            const sortedKeys = Object.keys(groups).sort();

            // 3. Render Tables
            sortedKeys.forEach(groupKey => {
                const dogs = groups[groupKey].sort((a, b) => Number(b[col_score]) - Number(a[col_score]));
                
                const h2 = document.createElement('h2');
                h2.className = 'group-header';
                h2.textContent = groupKey;
                container.appendChild(h2);

                const table = document.createElement('table');
                
                // HEADER ROW: Added Reg Nr column
                let html = `<thead><tr>
                    <th>#</th>
                    <th>${col_score}</th>
                    <th>${col_name}</th>
                    <th class="hide-mobile">Reg. nr</th>
                </tr></thead><tbody>`;
                
                dogs.forEach((dog, index) => {
                    const rank = index + 1;
                    const rankClass = rank <= 3 ? `rank-${rank}` : '';
                    const regNr = dog[col_reg] || '-'; // Shows '-' if empty
                    
                    // DATA ROW: Added Reg Nr cell
                    html += `<tr class="${rankClass}">
                        <td>${rank}</td>
                        <td><strong>${dog[col_score]}</strong></td>
                        <td>${dog[col_name]}</td>
                        <td class="hide-mobile"><small>${regNr}</small></td>
                    </tr>`;
                });
                
                html += "</tbody>";
                table.innerHTML = html;
                container.appendChild(table);
            });

            loadingMsg.style.display = 'none';
        },
        error: function(err) {
            document.getElementById('loadingMessage').innerText = "Kunne ikke laste data.";
            console.error("Error:", err);
        }
    });

    function updateTimestamp() {
        const now = new Date();
        const dateString = now.toLocaleDateString('no-NO', { day: '2-digit', month: '2-digit', year: 'numeric' });
        const timeString = now.toLocaleTimeString('no-NO', { hour: '2-digit', minute: '2-digit' });
        document.getElementById('last-updated').innerText = `Sist oppdatert: ${dateString} kl. ${timeString}`;
    }
</script>

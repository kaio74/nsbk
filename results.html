---
layout: default
title: Results
---

<style>
  /* --- Tab Navigation Styles --- */
  .tab-nav { overflow: hidden; border-bottom: 1px solid #ccc; margin-bottom: 20px; }
  .tab-nav a { float: left; display: block; color: #159957; text-align: center; padding: 14px 16px; text-decoration: none; font-size: 17px; border: 1px solid transparent; border-bottom: none; }
  .tab-nav a:hover { background-color: #f1f1f1; }
  .tab-nav a.active { background-color: #fff; border: 1px solid #ccc; border-bottom: 2px solid white; font-weight: bold; color: #000; margin-bottom: -1px; }
  
  /* --- Table Styles --- */
  table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
  th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
  th { background-color: #f2f2f2; font-weight: bold; }

  /* Rank Column (First Column) Tweaks */
  th:first-child, td:first-child { width: 50px; text-align: center; }

  /* Top 3 Leaderboard Highlights */
  tbody tr:nth-child(1) td { color: #d4af37; font-weight: bold; background-color: rgba(212, 175, 55, 0.1); } /* Gold */
  tbody tr:nth-child(2) td { color: #7a7a7a; font-weight: bold; background-color: rgba(192, 192, 192, 0.1); } /* Silver */
  tbody tr:nth-child(3) td { color: #cd7f32; font-weight: bold; background-color: rgba(205, 127, 50, 0.1); } /* Bronze */

  /* Loading Message Style */
  .loading { text-align: center; font-style: italic; color: #606c71; margin: 20px 0; }
</style>

<div class="tab-nav">
  <a href="./index.html">Påmelding</a>
  <a href="./results.html" class="active">Resultater</a>
</div>

<h2>Resultater fra årskonkurrasene</h2>
<p>Kontinuerlig oppdaterte inntil påmeldingsfrist er utløpt:</p>

<div id="loadingMessage" class="loading">Henter resultater...</div>

<table id="leaderboardTable" style="display:none;">
  <thead>
    </thead>
  <tbody>
    </tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
    // *** IMPORTANT: PASTE YOUR GOOGLE SHEET CSV LINK BELOW ***
    const sheetUrl = 'YOUR_PUBLISHED_GOOGLE_SHEET_LINK_HERE'; 

    Papa.parse(sheetUrl, {
        download: true,
        header: true,
        complete: function(results) {
            const data = results.data;
            const table = document.getElementById('leaderboardTable');
            const tableHead = table.querySelector('thead');
            const tableBody = table.querySelector('tbody');
            const loadingMsg = document.getElementById('loadingMessage');

            // 1. Create Headers (Dynamic based on Sheet)
            if (data.length > 0) {
                const headers = Object.keys(data[0]);
                let headerRow = '<tr><th>#</th>'; // Adds a Rank column
                headers.forEach(header => {
                    headerRow += `<th>${header}</th>`;
                });
                headerRow += '</tr>';
                tableHead.innerHTML = headerRow;
            }

            // 2. Create Rows
            data.forEach((row, index) => {
                // Skip empty rows in the sheet
                if (Object.values(row).every(x => x === null || x === '')) return;

                let htmlRow = `<tr>`;
                htmlRow += `<td>${index + 1}</td>`; // The Rank Number
                Object.values(row).forEach(cell => {
                    htmlRow += `<td>${cell}</td>`;
                });
                htmlRow += `</tr>`;
                tableBody.innerHTML += htmlRow;
            });

            // 3. Reveal the table
            loadingMsg.style.display = 'none';
            table.style.display = 'table';
        },
        error: function(err) {
            document.getElementById('loadingMessage').innerText = "Kunne ikke laste data.";
            console.error("Error:", err);
        }
    });
</script>
